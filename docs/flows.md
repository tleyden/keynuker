
```
                                                                                        
  _____ _ _   _           _       _   _                ______ _                         
 |  __ (_) | | |         | |     | | | |               |  ___| |                        
 | |  \/_| |_| |__  _   _| |__   | | | |___  ___ _ __  | |_  | | _____      __          
 | | __| | __| '_ \| | | | '_ \  | | | / __|/ _ \ '__| |  _| | |/ _ \ \ /\ / /          
 | |_\ \ | |_| | | | |_| | |_) | | |_| \__ \  __/ |    | |   | | (_) \ V  V /           
  \____/_|\__|_| |_|\__,_|_.__/   \___/|___/\___|_|    \_|   |_|\___/ \_/\_/            
                                                                                        
                                                                                        
       ┌──────────────────────────────────────────────────────────────────┐             
       │                                                                  │             
       │                                                                  │             
       │                    ┌─────────────────────────┐                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │         Action:         │                   │             
       │                    │  gihub-user-aggregator  │                   │             
       │                    │ that emits document of  │                   │             
       │                    │ all github users in an  │                   │             
       │                    │           org           │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    └─────────────────────────┘                   │             
       │                                 │   ┌──┐                         │             
       │                                 │   │  │                         │             
       │                                 │   │  │                         │             
       │                                 │   └──┘                         │             
       │                                 ▼                                │             
       │                    ┌─────────────────────────┐                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │   Action: save-to-db    │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    └─────────────────────────┘                   │             
       │                                                                  │             
       │                                                                  │             
       └──────────────────────────────────────────────────────────────────┘             
                                                                                        
                                                                                        
                                                                                        
                                                                                        
                                                                                        
                                                                                        
                                                                                        
                                                                                        
        ___  _    _ _____   _   __                ______ _                              
       / _ \| |  | /  ___| | | / /                |  ___| |                             
      / /_\ \ |  | \ `--.  | |/ /  ___ _   _ ___  | |_  | | _____      __               
      |  _  | |/\| |`--. \ |    \ / _ \ | | / __| |  _| | |/ _ \ \ /\ / /               
      | | | \  /\  /\__/ / | |\  \  __/ |_| \__ \ | |   | | (_) \ V  V /                
      \_| |_/\/  \/\____/  \_| \_/\___|\__, |___/ \_|   |_|\___/ \_/\_/                 
                                        __/ |                                           
                                       |___/                                            
                                                                                        
       ┌──────────────────────────────────────────────────────────────────┐             
       │                                                                  │             
       │                                                                  │             
       │                                                                  │             
       │                    ┌─────────────────────────┐                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │ Action: fetch-aws-keys  │                   │             
       │                    │ that emits document of  │                   │             
       │                    │ all aws keys in an aws  │                   │             
       │                    │         account         │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    └─────────────────────────┘                   │             
       │                                │   ┌──┐                          │             
       │                                │   │  │                          │             
       │                                │   │  │                          │             
       │                                │   └──┘                          │             
       │                                ▼                                 │             
       │                    ┌─────────────────────────┐                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │   Action: save-to-db    │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    │                         │                   │             
       │                    └─────────────────────────┘                   │             
       │                                                                  │             
       └──────────────────────────────────────────────────────────────────┘             
                                                                                        
                                                                                        
                                                                                        
                                                                                        
                                                                                        
                                                                                        
                _____                  ______ _                                         
               /  ___|                 |  ___| |                                        
               \ `--.  ___ __ _ _ __   | |_  | | _____      __                          
                `--. \/ __/ _` | '_ \  |  _| | |/ _ \ \ /\ / /                          
               /\__/ / (_| (_| | | | | | |   | | (_) \ V  V /                           
               \____/ \___\__,_|_| |_| \_|   |_|\___/ \_/\_/                            
                                                                                        
                                                                                        
   ┌───────────────────────────────────────────────────────────────────────────────────┐
   │                                                                                   │
   │  ┌──────────────────────────────────┐                                             │
   │  │   Action: Alarm every 15 mins    │                                             │
   │  └──────────────────────────────────┘                                             │
   │                    │                                                              │
   │                    │                                                              │
   │                    │                                                              │
   │                    ▼                                                              │
   │  ┌──────────────────────────────────┐                                             │
   │  │             Action:              │           ┌ ─ ─ ─ ─ ─ ─ ─ ─                 │
   │  │   lookup-github-users-aws-keys   │            (note, could be │                │
   │  │ merges github users and aws keys │─ ─ ─ ─ ─ ─│    _changes                     │
   │  │         into single doc          │                driven!)    │                │
   │  │                                  │           └ ─ ─ ─ ─ ─ ─ ─ ─                 │
   │  └──────────────────────────────────┘                                             │
   │                    │                ┌──────────────────────────────────┐          │
   │                    │  ┌──┐          │  Action: fan out and chunk.  No  │          │
   │                    │  │  │          │need for loop if chunks are small │          │
   │                    │  │  │          │              enough              │          │
   │                    │  └──┘          └──────────────────────────────────┘          │
   │                    ▼                                                              │
   │   ┌─────────────────────────────────┐                                             │
   │   │                                 │                                             │
   │   │             Action:             │                                             │
   │   │github-user-events-scanner scans │                                             │
   │   │github user events starting from │                                             │
   │   │ checkpoints, produces doc with  │                                             │
   │   │leaked keys and new checkpoints, │                                             │
   │   │      finished = true/false      │                                             │
   │   │                                 │                                             │
   │   │                                 │                                             │
   │   └─────────────────────────────────┘                                             │
   │                    │                                                              │
   │                    │                    ┌ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─               │
   │                    │     ┌──┐             (note, might not be able │              │
   │                    │     │  │           │      to catch up to                     │
   │                    │     │  │─ ─ ─ ─ ─ ─  checkpoints, how can it  │              │
   │                    │     └──┘           │         repeat?)                        │
   │                    │                                               │              │
   │                    ▼                    └ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─               │
   │       ┌─────────────────────────┐                                                 │
   │       │                         │                                                 │
   │       │         Action:         │                                                 │
   │       │  nuke-leaked-aws-keys   │                                                 │
   │       │   nukes leaked keys,    │                                                 │
   │       │produces a doc with nuked│                                                 │
   │       │   keys and propagated   │                                                 │
   │       │   updated checkpoints   │                                                 │
   │       │                         │                                                 │
   │       │                         │                                                 │
   │       └─────────────────────────┘                                                 │
   │                    │  ┌──┐                                                        │
   │                    │  │  │                                                        │
   │                    │  │  │                                                        │
   │                    │  └──┘                                                        │
   │                    │                                                              │
   │                    ▼                                                              │
   │       ┌─────────────────────────┐                                                 │
   │       │                         │                                                 │
   │       │   Action: save-to-db    │                                                 │
   │       │                         │                                                 │
   │       └─────────────────────────┘                                                 │
   │                                                                                   │
   │                                                                                   │
   │                                                                                   │
   └───────────────────────────────────────────────────────────────────────────────────┘

```
